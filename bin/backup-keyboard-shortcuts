#!/bin/bash

# Pop!_OS Keyboard Shortcuts Backup Script
# Usage: backup-keyboard-shortcuts [backup-name]

BACKUP_DIR="$HOME/.config/keyboard-shortcuts-backups"
BACKUP_NAME="${1:-keyboard-shortcuts-$(date +%Y%m%d-%H%M%S)}"
BACKUP_FILE="$BACKUP_DIR/$BACKUP_NAME"

# Create backup directory if it doesn't exist
mkdir -p "$BACKUP_DIR"

echo "Creating keyboard shortcuts backup: $BACKUP_FILE"

# Backup using dconf dump (proper format for restoration)
{
    echo "# Pop!_OS Keyboard Shortcuts Backup - $(date)"
    echo "# Run 'restore-keyboard-shortcuts $BACKUP_NAME' to restore these settings"
    echo ""
    dconf dump /org/gnome/desktop/wm/keybindings/
    dconf dump /org/gnome/settings-daemon/plugins/media-keys/
    dconf dump /org/gnome/mutter/
    dconf dump /org/gnome/mutter/keybindings/
    dconf dump /org/gnome/shell/keybindings/
    dconf dump /org/gnome/shell/extensions/pop-shell/
    dconf dump /org/gnome/desktop/interface/
} > "$BACKUP_FILE"

echo "Backup completed: $BACKUP_FILE"
echo "To restore, run: restore-keyboard-shortcuts $BACKUP_NAME"
